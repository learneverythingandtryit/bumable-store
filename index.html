<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BUMABLE - Underwear Revolution</title>
    <meta name="description" content="Mom approved. Girlfriend removed. Discover stylish men's underwear that owns the spotlight.">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css?v=20251201h">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <h1 class="logo">BUMABLE</h1>
                </div>
                
                <div class="nav-menu" id="nav-menu">
                    <ul class="nav-list">
                        <li><a href="#home" class="nav-link">Home</a></li>
                        <li><a href="#shop" class="nav-link">Shop</a></li>
                        <li><a href="#about" class="nav-link">Our Story</a></li>
                        <li><a href="#contact" class="nav-link">Contact Us</a></li>
                    </ul>
                </div>
                
                <div class="nav-actions">
                    <button class="btn-notifications" id="notifications-btn" onclick="toggleNotifications()" title="Notifications">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count" id="notification-count" style="display: none;">0</span>
                    </button>
                    <button class="btn-cart" onclick="toggleCart()">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count">0</span>
                    </button>
                    <button class="nav-toggle" id="nav-toggle">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>
            </div>
        </nav>
        
        <!-- Notifications Dropdown -->
        <div class="notifications-dropdown" id="notifications-dropdown" style="display: none;">
            <div class="notifications-header">
                <h3>Notifications</h3>
                <button class="close-notifications" onclick="closeNotifications()">&times;</button>
            </div>
            <div class="notifications-list" id="notifications-list">
                <div class="no-notifications">
                    <i class="fas fa-bell-slash"></i>
                    <p>No new notifications</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cart-sidebar">
        <div class="cart-header">
            <h3><i class="fas fa-shopping-cart"></i> Shopping Cart</h3>
            <button class="cart-close" onclick="toggleCart()">&times;</button>
        </div>
        
        <div class="empty-cart" style="text-align: center; padding: 2rem;">
            <i class="fas fa-shopping-cart" style="font-size: 3rem; color: #ccc; margin-bottom: 1rem;"></i>
            <p>Your cart is empty</p>
            <a href="shop/" class="btn btn-primary">Start Shopping</a>
        </div>
        
        <div class="cart-content" style="display: none;">
            <div class="cart-items-wrapper">
                <div class="cart-items" id="cart-items">
                    <!-- Cart items will be loaded here -->
                </div>
            </div>
            <div class="cart-footer">
                <!-- Cart footer will be updated by professional cart system -->
            </div>
        </div>
    </div>
        </div>
    </div>
    <div class="cart-overlay" id="cart-overlay" onclick="toggleCart()"></div>

    <!-- Main Content -->
    <main>
        <!-- Hero Section -->
        <section id="home" class="hero">
            <div class="hero-content">
                <div class="container">
                    <div class="hero-text">
                        <h1 class="hero-title">Mom approved<br>Girlfriend removed.</h1>
                        <p class="hero-subtitle">Underwear Revolution is where comfort meets cheeky confidence, offering unique underwear for both men and women who dare to stand out. It's not just underwear; it's an attitude you wear.</p>
                        <div class="hero-actions">
                            <a href="shop/" class="btn btn-primary">Shop Now</a>
                            <div class="sale-badge">
                                <span class="sale-text">Final Sale - Get 30% Off</span>
                            </div>
                        </div>
                    </div>
                    <div class="hero-image">
                        <img src="images/hero-product-1.jpg" alt="BUMABLE Premium Underwear Collection" class="hero-img">
                    </div>
                </div>
            </div>
        </section>

        <!-- Product Collection Section -->
        <section id="collection" class="collection-section">
            <div class="container">
                <h2 class="section-title">Discover BUMABLE</h2>
                <div class="collection-grid" id="collection-showcase">
                    <!-- üé® BUMABLE BRIEF COLLECTION -->
                    <a href="shop/?subcategory=bumable-brief" class="collection-post" data-subcategory="bumable-brief">
                        <img src="images/hero-product-1.jpg" alt="Bumable Brief - BUMABLE" class="collection-img">
                        <div class="collection-overlay">
                            <div class="collection-content">
                                <h3>üé® Bumable Brief</h3>
                                <p>Cheery Red, Olive, Lt Grey, Navy, Black</p>
                                <span class="collection-btn">Shop Briefs <i class="fas fa-arrow-right"></i></span>
                            </div>
                        </div>
                    </a>
                    
                    <!-- üåà TIE & DYE COLLECTION -->
                    <a href="shop/?subcategory=tie-and-dye" class="collection-post" data-subcategory="tie-and-dye">
                        <img src="images/products/tie-dye/tie-dye-1-main.jpg" alt="Tie and Dye Collection - BUMABLE" class="collection-img">
                        <div class="collection-overlay">
                            <div class="collection-content">
                                <h3>üåà Tie & Dye Collection</h3>
                                <p>Artistic patterns & unique designs</p>
                                <span class="collection-btn">Shop Tie-Dye <i class="fas fa-arrow-right"></i></span>
                            </div>
                        </div>
                    </a>
                    
                    <!-- üèÜ SOLID TRUNKS COLLECTION -->
                    <a href="shop/?subcategory=solid-trunks" class="collection-post" data-subcategory="solid-trunks">
                        <img src="images/trunk-treasure.jpg" alt="Solid Trunks - BUMABLE" class="collection-img">
                        <div class="collection-overlay">
                            <div class="collection-content">
                                <h3>üèÜ Solid Trunks</h3>
                                <p>Classic Colors & Premium Comfort</p>
                                <span class="collection-btn">Shop Trunks <i class="fas fa-arrow-right"></i></span>
                            </div>
                        </div>
                    </a>
                </div>
                
                <div class="collection-cta">
                    <div class="cta-content">
                        <h3>Ready to upgrade your confidence?</h3>
                        <p>Explore our complete collection and find your perfect fit</p>
                        <a href="shop/" class="btn btn-premium">
                            <span>Shop Full Collection</span>
                            <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Shop Section -->
        <section id="shop" class="shop-section">
            <div class="container">
                <div class="category-header" id="categoryHeader">
                    <h1 class="category-title">Shop Our Collection</h1>
                </div>
                <div class="product-grid" id="productGrid"></div>
            </div>
        </section>

        <script>
            // Initialize shop section on homepage using existing shop logic
            document.addEventListener('DOMContentLoaded', function() {
                // Wait for other scripts to load, then initialize shop section
                setTimeout(function() {
                    initHomepageShop();
                }, 1000);
            });
            
            function initHomepageShop() {
                // Make sure ProductManager is available
                if (!window.ProductManager) {
                    setTimeout(initHomepageShop, 500);
                    return;
                }
                
                // Create ProductManager instance if needed
                if (!window.productManager) {
                    window.productManager = new ProductManager();
                }
                
                // Load products into homepage shop section
                loadHomepageProducts();
            }
            
            function loadHomepageProducts() {
                const grid = document.getElementById("productGrid");
                if (!grid) {
                    console.error('productGrid not found');
                    return;
                }
                
                if (!window.productManager) {
                    console.error('productManager not available');
                    return;
                }
                
                let products = window.productManager.getAllProducts();
                if (!products || products.length === 0) {
                    grid.innerHTML = '<div style="text-align: center; padding: 2rem; color: #666;">No products available</div>';
                    return;
                }
                
                // Set product grid using shop page logic
                grid.innerHTML = products.map(product => {
                    const currentPrice = window.productManager.getCurrentPrice(product);
                    const discount = window.productManager.getDiscountPercentage(product);
                    
                    // Price display with sale info
                    let priceHtml = `<div class="product-price">‚Çπ${currentPrice.toLocaleString('en-IN')}`;
                    if (product.onSale && product.salePrice) {
                        priceHtml += ` <span class="original-price">‚Çπ${product.regularPrice.toLocaleString('en-IN')}</span>`;
                        priceHtml += ` <span class="discount-badge">${discount}% OFF</span>`;
                    }
                    priceHtml += `</div>`;
                    
                    return `
                        <div class="product-card" data-product-id="${product.id}" onclick="openProductModal('${product.id}')">
                            <div class="product-image" style="background-image: url(${product.image})"></div>
                            <div class="product-name">${product.name}</div>
                            ${priceHtml}
                            <div class="shopping-controls">
                                <div class="size-selection">
                                    <label>Size:</label>
                                    <div class="card-size-options-grid">
                                        ${product.availableSizes.map(size => 
                                            `<div class="card-size-option" data-size="${size}" data-product-id="${product.id}" onclick="event.stopPropagation(); selectCardSize('${product.id}', '${size}')">${size}</div>`
                                        ).join('')}
                                    </div>
                                </div>
                                <div class="quantity-selection">
                                    <label>Quantity:</label>
                                    <div class="quantity-controls">
                                        <button type="button" data-product-id="${product.id}" data-change="-1" class="qty-btn qty-decrease">-</button>
                                        <span id="qty-display-${product.id}" class="qty-display">0</span>
                                        <button type="button" data-product-id="${product.id}" data-change="1" class="qty-btn qty-increase">+</button>
                                    </div>
                                </div>
                                <button onclick="event.stopPropagation(); addProductToCart('${product.id}')" class="add-to-cart-btn" ${product.stockCount === 0 ? 'disabled' : ''}>
                                    ${product.stockCount === 0 ? 'Out of Stock' : 'Add to Cart'}
                                </button>
                            </div>
                        </div>
                    `;
                }).join("");
                
                // Add event listeners as backup for quantity buttons
                setTimeout(function() {
                    const qtyButtons = document.querySelectorAll('.qty-btn');
                    
                    qtyButtons.forEach((button) => {
                        if (!button.hasAttribute('data-listener-added')) {
                            button.addEventListener('click', function(e) {
                                e.stopPropagation();
                                e.preventDefault();
                                
                                const productId = button.getAttribute('data-product-id');
                                const change = parseInt(button.getAttribute('data-change'));
                                
                                window.changeQuantity(productId, change);
                            });
                            button.setAttribute('data-listener-added', 'true');
                        }
                    });
                }, 1000);
            }
        </script>
        
        <script>
        // Shop page functions for homepage - moved to global scope
        window.changeQuantity = function(productId, change) {
            const qtyDisplay = document.getElementById(`qty-display-${productId}`);
            if (!qtyDisplay) {
                return;
            }
            
            if (!window.productManager) {
                return;
            }
            
            const product = window.productManager.getProduct(productId);
            if (!product) {
                return;
            }
            
            let currentQty = parseInt(qtyDisplay.textContent) || 0;
            let newQty = currentQty + change;
            
            // Minimum quantity is 0
            if (newQty < 0) newQty = 0;
            
            // Maximum quantity is stock count or 10, whichever is smaller
            const maxQty = Math.min(product.stockCount, 10);
            if (newQty > maxQty) newQty = maxQty;
            
            qtyDisplay.textContent = newQty;
            
            // Always sync with modal if open for this product
            if (window.currentModalProduct && window.currentModalProduct.id === productId) {
                window.modalQuantity = newQty;
                const modalQtyDisplay = document.getElementById('modalQtyDisplay');
                if (modalQtyDisplay) {
                    modalQtyDisplay.value = window.modalQuantity;
                    if (typeof updateQuantityButtons === 'function') updateQuantityButtons();
                    if (typeof updateAddToCartButton === 'function') updateAddToCartButton();
                }
            }
        };

        window.selectCardSize = function(productId, size) {
            // Remove selected class from all size options for this product
            const sizeOptions = document.querySelectorAll(`[data-product-id="${productId}"].card-size-option`);
            sizeOptions.forEach(opt => opt.classList.remove('selected'));
            
            // Add selected class to clicked option
            const selectedOption = document.querySelector(`[data-product-id="${productId}"][data-size="${size}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }
        };

        window.addProductToCart = function(productId) {
            const selectedSizeElement = document.querySelector(`[data-product-id="${productId}"].card-size-option.selected`);
            const qtyDisplay = document.getElementById(`qty-display-${productId}`);
            
            if (!window.productManager) return;
            
            const product = window.productManager.getProduct(productId);
            if (!product) return;
            
            // Check if product is in stock
            if (product.stockCount === 0) {
                showNotification('Product is out of stock', 'error');
                return;
            }
            
            if (!selectedSizeElement) {
                showNotification('Please select a size', 'warning');
                return;
            }
            
            const selectedSize = selectedSizeElement.getAttribute('data-size');
            const selectedQuantity = parseInt(qtyDisplay.textContent) || 0;
            
            // Check if quantity is greater than 0
            if (selectedQuantity === 0) {
                showNotification('Please select a quantity greater than 0', 'warning');
                return;
            }
            
            // Validate quantity against stock
            if (selectedQuantity > product.stockCount) {
                showNotification(`Only ${product.stockCount} items available in stock`, 'error');
                return;
            }

            // Call the cart system's addToCart function with proper parameters
            addToCart(productId, selectedSize, selectedQuantity);
            
            // Reset form and quantity back to 0
            selectedSizeElement.classList.remove('selected');
            qtyDisplay.textContent = '0';
        };
        </script>

        <!-- About Section -->
        <section id="about" class="about-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Our Story</h2>
                    <p class="section-subtitle">Where comfort meets cheeky confidence</p>
                </div>
                
                <div class="about-content">
                    <div class="about-text">
                        <h3>Mom approved. Girlfriend removed.</h3>
                        <p>Underwear Revolution is where comfort meets cheeky confidence, offering unique underwear for both men and women who dare to stand out. It's not just underwear; it's an attitude you wear.</p>
                        
                        <p>At BUMABLE, we believe that what you wear closest to your skin should make you feel confident, comfortable, and ready to take on the world. Our premium collection combines innovative fabric technology with bold, contemporary designs that speak to your personality.</p>
                        
                        <div class="about-features">
                            <div class="feature-item">
                                <i class="fas fa-heart"></i>
                                <h4>Comfort First</h4>
                                <p>Premium materials for all-day comfort</p>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-star"></i>
                                <h4>Quality Assured</h4>
                                <p>Rigorous testing for durability and fit</p>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-leaf"></i>
                                <h4>Eco-Conscious</h4>
                                <p>Sustainable materials and processes</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="about-image">
                        <img src="images/hero-product-2.jpg" alt="BUMABLE Story" class="about-img">
                    </div>
                </div>
            </div>
        </section>

        <!-- Instagram Section -->
        <section class="instagram-section">
            <div class="container">
                <h2 class="section-title">Connect on Instagram</h2>
                <div class="instagram-grid" id="instagram-feed">
                    <div class="instagram-post">
                        <img src="images/hero-product-1.jpg" alt="New Collections - BUMABLE" class="insta-img">
                        <div class="insta-overlay">
                            <i class="fab fa-instagram"></i>
                        </div>
                    </div>
                    <div class="instagram-post">
                        <img src="images/trunk-treasure.jpg" alt="Comfort First - BUMABLE" class="insta-img">
                        <div class="insta-overlay">
                            <i class="fab fa-instagram"></i>
                        </div>
                    </div>
                    <div class="instagram-post">
                        <img src="images/hipsters.jpg" alt="Style Guide - BUMABLE" class="insta-img">
                        <div class="insta-overlay">
                            <i class="fab fa-instagram"></i>
                        </div>
                    </div>
                    <div class="instagram-post">
                        <img src="images/hero-product-2.jpg" alt="Behind the Scenes - BUMABLE" class="insta-img">
                        <div class="insta-overlay">
                            <i class="fab fa-instagram"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer id="contact" class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 class="footer-title">Get in Touch</h3>
                    <div class="contact-info">
                        <p class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            Palavanchipalayam<br>
                            Tiruppur, Tamilnadu<br>
                            641605
                        </p>
                        <p class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:ingeniumcouture@gmail.com">ingeniumcouture@gmail.com</a>
                        </p>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#home">Home</a></li>
                        <li><a href="shop/">Shop</a></li>
                        <li><a href="#about">Our Story</a></li>
                        <li><a href="#contact">Contact Us</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Policies</h3>
                    <ul class="footer-links">
                        <li><a href="policy/">Store Policy</a></li>
                        <li><a href="shipping/">Shipping & Returns</a></li>
                        <li><a href="faq/">FAQ</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Follow Us</h3>
                    <div class="social-links">
                        <a href="https://www.facebook.com/profile.php?id=61560298989888" target="_blank" class="social-link">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="https://www.instagram.com/bumableclothing/" target="_blank" class="social-link">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://in.pinterest.com/bumableclothing/" target="_blank" class="social-link">
                            <i class="fab fa-pinterest"></i>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p style="margin-bottom: 0;">
                    <span id="admin-link-home" style="color: #ccc; text-decoration: none; cursor: pointer; display: inline-block; padding: 8px 15px; border-radius: 5px; transition: all 0.3s ease; border: 1px solid transparent; user-select: none;" onmouseover="this.style.backgroundColor='rgba(255,255,255,0.1)'; this.style.borderColor='rgba(255,255,255,0.2)'" onmouseout="this.style.backgroundColor='transparent'; this.style.borderColor='transparent'">
                        &copy; 2025 by BUMABLE. All rights reserved.
                    </span>
                </p>
            </div>
        </div>
    </footer>

    <!-- Contact Form Modal -->
    <div id="contact-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Contact Us</h2>
            <form class="contact-form" id="contact-form">
                <div class="form-group">
                    <input type="text" name="firstName" placeholder="First Name *" required>
                    <input type="text" name="lastName" placeholder="Last Name *" required>
                </div>
                <div class="form-group">
                    <input type="email" name="email" placeholder="Email *" required>
                </div>
                <div class="form-group">
                    <textarea name="message" placeholder="Message *" rows="5" required></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Send Message</button>
                <div id="form-message" style="margin-top: 1rem; padding: 0.5rem; border-radius: 5px; display: none;"></div>
            </form>
        </div>
    </div>

    <!-- Product Preview Modal -->
    <div class="product-modal" id="productModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeProductModal()">&times;</button>
            <div class="modal-body">
                <div class="modal-image-section">
                    <div class="modal-main-image" id="modalMainImage"></div>
                    <div class="modal-thumbnails" id="modalThumbnails">
                        <!-- Thumbnails will be loaded here -->
                    </div>
                </div>
                <div class="modal-details-section">
                    <h1 class="modal-product-name" id="modalProductName"></h1>
                    <div class="modal-product-price" id="modalProductPrice"></div>
                    <div class="modal-description" id="modalProductDescription"></div>
                    
                    <div class="modal-size-selection">
                        <label for="modalSizeSelector">SIZE:</label>
                        <div class="size-options-grid">
                            <div class="size-option" data-size="S">S</div>
                            <div class="size-option" data-size="M">M</div>
                            <div class="size-option" data-size="L">L</div>
                            <div class="size-option" data-size="XL">XL</div>
                            <div class="size-option" data-size="XXL">XXL</div>
                        </div>
                        <select id="modalSizeSelector" class="modal-size-selector" required>
                            <option value="">Choose Size</option>
                        </select>
                    </div>
                    
                    <div class="modal-quantity-selection">
                        <label>QUANTITY:</label>
                        <div class="modal-quantity-controls">
                            <span class="quantity-label">QTY</span>
                            <div class="quantity-input-group">
                                <button type="button" class="modal-qty-btn" onclick="changeModalQuantity(-1)">‚àí</button>
                                <input type="number" id="modalQtyDisplay" class="modal-qty-display" value="1" min="1" max="10" readonly>
                                <button type="button" class="modal-qty-btn" onclick="changeModalQuantity(1)">+</button>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="addModalProductToCart()" class="modal-add-to-cart-btn" id="modalAddToCartBtn">
                        Add to Cart
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/github-database-complete.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/products.js"></script>
    <script src="js/main.js"></script>
    
    <script>
        // Global variables for modal
        window.currentModalProduct = null;
        window.modalQuantity = 0; // Start with 0 to match homepage default
        
        // Open product modal
        function openProductModal(productId) {
            const product = window.productManager.getProduct(productId);
            if (!product) return;
            
            window.currentModalProduct = product;
            
            // Get current quantity from homepage card
            const homepageQtyDisplay = document.getElementById(`qty-display-${productId}`);
            const currentHomepageQty = homepageQtyDisplay ? parseInt(homepageQtyDisplay.textContent) || 0 : 0;
            window.modalQuantity = Math.max(0, currentHomepageQty); // Sync with homepage, min 0
            
            // Update modal content
            document.getElementById('modalProductName').textContent = product.name;
            
            // Price display
            let priceHtml = `‚Çπ${product.salePrice || product.regularPrice}`;
            if (product.onSale && product.salePrice) {
                priceHtml += `<span class="modal-original-price">‚Çπ${product.regularPrice}</span>`;
                const discount = Math.round((1 - product.salePrice / product.regularPrice) * 100);
                priceHtml += `<span class="modal-discount-badge">${discount}% OFF</span>`;
            }
            document.getElementById('modalProductPrice').innerHTML = priceHtml;
            
            // Description
            document.getElementById('modalProductDescription').textContent = product.description || 'Premium quality underwear crafted for ultimate comfort and style.';
            
            // Main image
            const mainImage = product.images && product.images[0] ? product.images[0] : product.image;
            document.getElementById('modalMainImage').style.backgroundImage = `url(${mainImage})`;
            
            // Thumbnails
            const thumbnailsContainer = document.getElementById('modalThumbnails');
            thumbnailsContainer.innerHTML = '';
            
            if (product.images && product.images.length > 1) {
                product.images.forEach((image, index) => {
                    const thumbnail = document.createElement('div');
                    thumbnail.className = `modal-thumbnail ${index === 0 ? 'active' : ''}`;
                    thumbnail.style.backgroundImage = `url(${image})`;
                    thumbnail.onclick = () => switchModalImage(image, thumbnail);
                    thumbnailsContainer.appendChild(thumbnail);
                });
            }
            
            // Setup size selection
            const sizeGrid = document.querySelector('.size-options-grid');
            const sizeSelector = document.getElementById('modalSizeSelector');
            sizeSelector.innerHTML = '<option value="">Choose Size</option>';
            
            // Clear existing size options
            sizeGrid.innerHTML = '';
            
            // Create size options for the grid
            const allSizes = ['S', 'M', 'L', 'XL', 'XXL'];
            allSizes.forEach(size => {
                const sizeOption = document.createElement('div');
                sizeOption.className = 'size-option';
                sizeOption.setAttribute('data-size', size);
                sizeOption.textContent = size;
                
                // Check if size is available
                if (product.availableSizes && product.availableSizes.includes(size)) {
                    sizeOption.addEventListener('click', function() {
                        selectSize(size, this);
                    });
                    
                    // Add to select dropdown too (hidden)
                    const option = document.createElement('option');
                    option.value = size;
                    option.textContent = size;
                    sizeSelector.appendChild(option);
                } else {
                    sizeOption.classList.add('unavailable');
                }
                
                sizeGrid.appendChild(sizeOption);
            });
            
            // Reset quantity display to sync with homepage
            const qtyDisplay = document.getElementById('modalQtyDisplay');
            qtyDisplay.value = window.modalQuantity;
            updateQuantityButtons();
            updateAddToCartButton();
            
            // Show modal
            const modal = document.getElementById('productModal');
            modal.style.display = 'flex';
            setTimeout(() => modal.classList.add('show'), 10);
            
            // Prevent body scroll
            document.body.style.overflow = 'hidden';
        }
        
        // Size selection function
        function selectSize(size, element) {
            // Remove selected class from all size options
            document.querySelectorAll('.size-option').forEach(opt => opt.classList.remove('selected'));
            
            // Add selected class to clicked option
            element.classList.add('selected');
            
            // Update the hidden select element
            document.getElementById('modalSizeSelector').value = size;
            
            // Add tactile feedback
            element.style.transform = 'scale(1.1)';
            setTimeout(() => {
                element.style.transform = '';
            }, 200);
        }
        
        // Close product modal
        function closeProductModal() {
            const modal = document.getElementById('productModal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }, 300);
        }
        
        // Switch modal main image
        function switchModalImage(imageSrc, clickedThumbnail) {
            const mainImage = document.getElementById('modalMainImage');
            
            mainImage.style.opacity = '0.6';
            mainImage.style.transform = 'scale(0.98)';
            
            setTimeout(() => {
                mainImage.style.backgroundImage = `url(${imageSrc})`;
                mainImage.style.opacity = '1';
                mainImage.style.transform = 'scale(1)';
            }, 200);
            
            // Update active thumbnail
            document.querySelectorAll('.modal-thumbnail').forEach(thumb => thumb.classList.remove('active'));
            clickedThumbnail.classList.add('active');
        }
        
        // Modal quantity change
        function changeModalQuantity(delta) {
            const qtyDisplay = document.getElementById('modalQtyDisplay');
            const currentQty = parseInt(qtyDisplay.value) || 0; // Default to 0 if invalid
            const newQuantity = currentQty + delta;
            
            // Allow 0 minimum, max 10
            if (newQuantity >= 0 && newQuantity <= 10) {
                window.modalQuantity = newQuantity;
                qtyDisplay.value = window.modalQuantity;
                
                // Always sync with homepage for current product
                if (window.currentModalProduct) {
                    const homepageQtyDisplay = document.getElementById(`qty-display-${window.currentModalProduct.id}`);
                    if (homepageQtyDisplay) {
                        homepageQtyDisplay.textContent = window.modalQuantity;
                    }
                }
                
                qtyDisplay.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    qtyDisplay.style.transform = 'scale(1)';
                }, 150);
            }
            
            updateQuantityButtons();
            updateAddToCartButton();
        }
        
        // Update quantity button states
        function updateQuantityButtons() {
            const buttons = document.querySelectorAll('.modal-qty-btn');
            const decreaseBtn = buttons[0];
            const increaseBtn = buttons[1];
            
            if (decreaseBtn) {
                decreaseBtn.disabled = window.modalQuantity <= 0; // Allow decrease to 0
                decreaseBtn.style.opacity = window.modalQuantity <= 0 ? '0.3' : '1';
            }
            
            if (increaseBtn) {
                increaseBtn.disabled = window.modalQuantity >= 10;
                increaseBtn.style.opacity = window.modalQuantity >= 10 ? '0.3' : '1';
            }
        }
        
        // Update Add to Cart button based on quantity and size
        function updateAddToCartButton() {
            const addToCartBtn = document.getElementById('modalAddToCartBtn');
            if (addToCartBtn) {
                if (window.modalQuantity === 0) {
                    addToCartBtn.disabled = true;
                    addToCartBtn.style.opacity = '0.6';
                    addToCartBtn.textContent = 'Select Quantity';
                } else {
                    addToCartBtn.disabled = false;
                    addToCartBtn.style.opacity = '1';
                    addToCartBtn.textContent = 'ADD TO CART';
                }
            }
        }
        
        // Add to cart from modal
        function addModalProductToCart() {
            if (!window.currentModalProduct) return;
            
            const sizeSelector = document.getElementById('modalSizeSelector');
            const addToCartBtn = document.getElementById('modalAddToCartBtn');
            
            // Check quantity first
            if (window.modalQuantity === 0) {
                alert('Please select quantity greater than 0');
                return;
            }
            
            // Check size selection
            if (!sizeSelector.value) {
                const sizeGrid = document.querySelector('.size-options-grid');
                sizeGrid.style.animation = 'shake 0.6s ease-in-out';
                
                setTimeout(() => {
                    sizeGrid.style.animation = '';
                }, 600);
                
                alert('Please select a size');
                return;
            }
            
            // Add loading state
            addToCartBtn.classList.add('loading');
            addToCartBtn.textContent = 'Adding...';
            addToCartBtn.disabled = true;
            
            setTimeout(() => {
                // Use the cart system
                addToCart(window.currentModalProduct.id, sizeSelector.value, window.modalQuantity);
                
                // Success state
                addToCartBtn.classList.remove('loading');
                addToCartBtn.classList.add('success');
                addToCartBtn.textContent = '‚úì Added to Cart!';
                
                // Reset after success
                setTimeout(() => {
                    addToCartBtn.classList.remove('success');
                    addToCartBtn.textContent = 'ADD TO CART';
                    addToCartBtn.disabled = false;
                    
                    closeProductModal();
                }, 2000);
            }, 1000);
        }
        
        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('productModal');
            if (e.target === modal) {
                closeProductModal();
            }
        });
        
        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && document.getElementById('productModal').style.display === 'flex') {
                closeProductModal();
            }
        });
        
        // Admin redirect functionality for homepage
        document.addEventListener('DOMContentLoaded', function() {
            const adminLinkHome = document.getElementById('admin-link-home');
            if (adminLinkHome) {
                adminLinkHome.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Homepage copyright clicked - redirecting to admin');
                    
                    // Try multiple redirect methods
                    try {
                        // Method 1: Direct window location
                        window.location.href = 'admin/';
                    } catch (error) {
                        console.log('Method 1 failed, trying method 2');
                        // Method 2: Using assign
                        try {
                            window.location.assign('admin/');
                        } catch (error2) {
                            console.log('Method 2 failed, trying method 3');
                            // Method 3: Using replace
                            try {
                                window.location.replace('admin/');
                            } catch (error3) {
                                console.log('All redirect methods failed:', error3);
                                // Method 4: Open in new tab as fallback
                                window.open('admin/', '_blank');
                            }
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>